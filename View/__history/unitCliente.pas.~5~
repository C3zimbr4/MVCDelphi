unit unitCliente;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Mask, StdCtrls, ExtCtrls, Buttons;

type
  TfrmCadastroClientes = class(TForm)
    lblTitulo: TLabel;
    Panel: TPanel;
    lblCodigo: TLabel;
    lblNome: TLabel;
    lblCPF: TLabel;
    edtCodigo: TEdit;
    edtNome: TEdit;
    Bevel: TBevel;
    btnSalvar: TBitBtn;
    lblInfo1: TLabel;
    edtUF: TEdit;
    lblCidade: TLabel;
    edtCidade: TEdit;
    procedure btnSalvarClick(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word;
      Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  frmCadastroClientes: TfrmCadastroClientes;

implementation

uses
  classeCliente, controleCliente;

{$R *.dfm}

procedure TfrmCadastroClientes.btnSalvarClick(Sender: TObject);
var
  // variáveis das camadas utilizadas na rotina
  objetoCliente: TCliente;
  objetoControle: TControleCliente;
  retorno: string;
begin
  // instanciação dos objetos
  objetoCliente  := TCliente.Create; // classe Modelo
  objetoControle := TControleCliente.Create; // classe Controle
  try
    // preenchimento dos dados
    objetoCliente.Codigo := StrToIntDef(edtCodigo.Text, 0);
    objetoCliente.Nome   := Trim(edtNome.Text);
    objetoCliente.UF    := edtUF.Text;
    objetoCliente.Cidade    := edtCidade.Text;

    // chamada da rotina para gravação
    retorno := objetoControle.Salvar(objetoCliente);
    if retorno <> '' then
       lblInfo1.Caption := retorno
    else
       lblInfo1.Caption := 'Dados Salvos com Sucesso';

    //Limpa os Campos para o próximo cadastro.
    edtCodigo.Clear;
    edtNome.Clear;
    edtUF.Clear;
    edtCidade.Clear;
    edtCodigo.SetFocus;
  finally
    // liberação dos objetos da memória
    FreeAndNil(objetoCliente);
    FreeAndNil(objetoControle);
  end;
end;

procedure TfrmCadastroClientes.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  if Key = VK_ESCAPE then
    Close;
end;

end.
